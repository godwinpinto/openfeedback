{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "rewriter",
  "type": "registry:lib",
  "title": "Rewriter",
  "description": "Chrome Rewriter API wrapper for text rewriting with streaming support.",
  "dependencies": [
    "react"
  ],
  "files": [
    {
      "path": "registry/new-york/gencn-ui/items/shared/block/lib/gui-types.ts",
      "content": "// Type definitions for Chrome Summarizer API\nexport interface SummarizerOptions {\n  sharedContext?: string;\n  type?: \"key-points\" | \"tldr\" | \"teaser\" | \"headline\";\n  format?: \"markdown\" | \"plain-text\";\n  length?: \"short\" | \"medium\" | \"long\";\n  expectedInputLanguages?: string[];\n  outputLanguage?: string;\n  expectedContextLanguages?: string[];\n  monitor?: (monitor: any) => void;\n}\n\nexport interface SummarizeOptions {\n  context?: string;\n}\n\nexport interface SummarizeSelectionProps {\n  className?: string;\n  defaultOptions?: SummarizerOptions;\n  dialogTitle?: string;\n}\n\nexport interface ButtonPosition {\n  top: number;\n  left: number;\n  visible: boolean;\n}\n\nexport interface UseSummarizerOptions extends SummarizerOptions {\n  context?: string;\n}\n\n// Type definitions for Chrome Writer API\nexport interface WriterOptions {\n  sharedContext?: string;\n  tone?: \"formal\" | \"neutral\" | \"casual\";\n  format?: \"markdown\" | \"plain-text\";\n  length?: \"short\" | \"medium\" | \"long\";\n  expectedInputLanguages?: string[];\n  expectedContextLanguages?: string[];\n  outputLanguage?: string;\n  monitor?: (monitor: any) => void;\n  signal?: AbortSignal;\n}\n\nexport interface WriteOptions {\n  context?: string;\n}\n\n// Type definitions for Chrome Rewriter API\nexport interface RewriterOptions {\n  sharedContext?: string;\n  tone?: \"more-formal\" | \"as-is\" | \"more-casual\";\n  format?: \"as-is\" | \"markdown\" | \"plain-text\";\n  length?: \"shorter\" | \"as-is\" | \"longer\";\n  expectedInputLanguages?: string[];\n  expectedContextLanguages?: string[];\n  outputLanguage?: string;\n  monitor?: (monitor: any) => void;\n  signal?: AbortSignal;\n}\n\nexport interface RewriteOptions {\n  context?: string;\n  signal?: AbortSignal;\n}\n",
      "type": "registry:lib"
    },
    {
      "path": "registry/new-york/gencn-ui/items/shared/lib/rewriter.ts",
      "content": "'use client';\n\nimport type { RewriterOptions, RewriteOptions } from '@/registry/new-york/gencn-ui/items/shared/block/lib/gui-types';\n\nexport type RewriterAvailability = 'available' | 'downloadable' | 'unavailable' | null;\n\nexport function isRewriterSupported(): boolean {\n\treturn 'Rewriter' in self;\n}\n\nexport async function checkRewriterAvailability(): Promise<RewriterAvailability> {\n\tif (!isRewriterSupported()) return null;\n\ttry {\n\t\tconst status = await (self as any).Rewriter.availability();\n\t\treturn status as RewriterAvailability;\n\t} catch {\n\t\treturn null;\n\t}\n}\n\nexport async function ensureRewriter(options?: RewriterOptions & { onProgress?: (percent: number) => void }): Promise<any> {\n\tif (!isRewriterSupported()) {\n\t\tthrow new Error('Chrome Rewriter API is not supported.');\n\t}\n\n\tconst availability = await checkRewriterAvailability();\n\tif (availability === 'unavailable' || availability === null) {\n\t\tthrow new Error('Rewriter API is unavailable on this device.');\n\t}\n\n\tconst createOptions: any = {\n\t\t...options,\n\t\tmonitor: (monitor: any) => {\n\t\t\tif (options?.monitor) {\n\t\t\t\toptions.monitor(monitor);\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tmonitor?.addEventListener?.('downloadprogress', (e: any) => {\n\t\t\t\t\tif (typeof e.loaded === 'number') {\n\t\t\t\t\t\toptions?.onProgress?.(Math.round(e.loaded * 100));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} catch {}\n\t\t},\n\t};\n\n\tconst rewriter = await (self as any).Rewriter.create(createOptions);\n\treturn rewriter;\n}\n\nexport async function rewriteOnce(\n\ttext: string,\n\toptions?: (RewriterOptions & { onProgress?: (percent: number) => void }) & RewriteOptions\n): Promise<string> {\n\tif (!text.trim()) {\n\t\tthrow new Error('Please enter some text to improve.');\n\t}\n\n\tconst rewriter = await ensureRewriter(options);\n\tconst result = await rewriter.rewrite(text, { context: options?.context, signal: options?.signal });\n\treturn result as string;\n}\n\nexport async function* rewriteStreaming(\n\ttext: string,\n\toptions?: (RewriterOptions & { signal?: AbortSignal; onProgress?: (percent: number) => void }) & RewriteOptions\n): AsyncGenerator<string> {\n\tif (!text.trim()) {\n\t\tthrow new Error('Please enter some text to improve.');\n\t}\n\n\tconst rewriter = await ensureRewriter(options);\n\tconst stream = rewriter.rewriteStreaming(text, { context: options?.context, signal: options?.signal });\n\tlet acc = '';\n\tfor await (const chunk of stream) {\n\t\tacc += chunk;\n\t\tyield acc as string;\n\t}\n}\n\n\n",
      "type": "registry:lib"
    }
  ]
}